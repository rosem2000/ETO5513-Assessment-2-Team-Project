---
title: 'ETO5513 Assessment 2: Team Project'
author: "Megan O'Rorke 35602287 & Aldwin Chong"
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output:
  bookdown::html_document2:
    keep_md: true
    toc: true
    toc_float: true
    theme: journal
    highlight: kate
bibliography: references.bib # ChatGPT (2024)
# Add nocite field so that references for R packages are still generated even though they are not explicitly cited in the report text
nocite: | 
  @*
csl: apa.csl # To cite APA style for Monash guidelines
---

```{r setup, include=FALSE}
# Set up figure rendering options for document
knitr::opts_chunk$set(fig.path = "Figures/", fig.align = "center", out.width = "70%")
```

```{r loading-libraries, message = FALSE, warning = FALSE, echo = FALSE}
# Load required libraries
    library(rmarkdown)
    library(knitr)
    library(tidyverse)
    library(readr)
    library(kableExtra)
    library(ggplot2)
    library(gridExtra)
    library(readxl)
    library(plotly)
    library(lubridate)
```

## Introduction

## Analysis - Megan O'Rorke

With **21%** of all trips in Melbourne being walked [@walkmatters], this makes walking the second most popular mode of transportation after driving.

Utilising the subset of [@peddata], this section of analysis will explore the below research questions to highlight prevalent trends within Melbourne pedestrian traffic from August 2023 to August 2025.

- **Does pedestrian traffic in Melbourne experience annual seasonality?**
- **How has Melbourne pedestrian traffic changed over time?** 
- **Which are the busiest locations in Melbourne for pedestrian traffic?**

### Seasonality

Does Melbourne's often unpredictable seasonal weather impact on pedestrian traffic trends? The dataset is reformatted, grouping each pedestrian reading into its associated year and season to analyse seasonality.

```{r load-the-data, echo = FALSE, warning = FALSE, message = FALSE}
ped_data_megan <- read_xlsx("Data/ped_data.xlsx")
```

```{r clean-data, echo = TRUE, warning = FALSE, message = FALSE}
# Convert Sensing_Date column to date format for analysis (Sanderson 2024)
ped_data_megan1 <- ped_data_megan %>%
  mutate(Sensing_Date = date(Sensing_Date)) %>%
# Create Month and Year columns derived from the Sensing_Date values
  mutate(Month = month(Sensing_Date, label=TRUE), 
         Year = year(Sensing_Date)) %>%
# Create a season column by grouping each month into Summer, Autumn, Winter or Spring
  mutate(Season = ifelse(Month %in% c("Jan", "Feb", "Dec"), "Summer", 
                  ifelse(Month %in% c("Mar", "Apr", "May"), "Autumn", 
                  ifelse(Month %in% c("Jun", "Jul", "Aug"), "Winter", 
                  ifelse(Month %in% c("Sep", "Oct", "Nov"), "Spring", NA)))))
```

```{r seasonal-totals, echo = FALSE, warning = FALSE, message = FALSE}
# Create Seasonal_Peds total sum for analysis
seasonal_totals <- ped_data_megan1 %>%
  group_by(Year, Season) %>%
  summarise(Seasonal_Peds = sum(Total_Peds, na.rm=TRUE), .groups = "drop") %>%
  # Create a factor of the Season column so seasons are displayed in correct order
  mutate(Season = factor(Season, levels = c("Summer", "Autumn", "Winter", "Spring"))) %>%
  arrange(Year, Season)
# Create a table of the seasonal_totals and add caption
knitr::kable(seasonal_totals, caption = "Total Melbourne Pedestrians Per Season (all sensor locations), 2023-2025")
```
In Table \@ref(tab:seasonal-totals) above, an annual trend can be observed whereby Melbourne pedestrian traffic reduces significantly in winter each year. 

Autumn and spring return similar pedestrian levels to summer annually, however spring of 2023 significantly exceeded the summer pedestrian traffic in the same year. This may be attributed to the extremity of heat in summer discouraging pedestrians, or to many Melbournians vacationing over that period, disrupting regular work and school commuting patterns.

*(Note: Summer of 2025 data is incomplete with only January included and winter of 2023 is incomplete with only August included in this dataset. Autumn of 2023 omitted from analysis.)*

The bar chart below depicts the seasonal trends in pedestrian traffic over time, from 2023 to 2025.

```{r stacked-bar-chart-seasonality, fig.cap = "Seasonality of Melbourne Pedestrian Traffic, 2023-2025", echo = TRUE, warning = FALSE, message = FALSE, out.width = "100%"}
# Use ggplot to create basic plot
# Plot year on x axis, value on y axis, and ensure the fill of bars is set to each measure
stacked_bar_chart <- seasonal_totals %>%
  group_by(Year, Season) %>%
  ggplot(aes(x=Year, y=Seasonal_Peds, fill = Season)) +
  # Set bar position to fill for the proportion of pedestrians each season
  geom_bar(stat = "identity", position = "fill") +
  labs(x = "Year", 
       y = "Proportion of Pedestrians",
       fill = "Season") +
  # Set theme
  theme_light()
# Save basic plot to Figures folder
ggsave(
  filename = "figures/seasonality_bar_chart.png", 
  plot = stacked_bar_chart,
  width = 8,
  height = 6,
  dpi = 300)
# Use ggplotly from plotly package to make plot interactive
ggplotly(stacked_bar_chart)
```
In Figure \@ref(fig:stacked-bar-chart-seasonality), due to incomplete data observations for 2023 and 2025 it is difficult to comment on seasonality over time.

From the complete 2024 seasonal data, it is observed that summer and autumn share the highest proportion of pedestrians, around 25.6%, with spring following closely at 25.2%. Whilst winter trails only by 1.7%, this does suggest a slight decline in pedestrian activity over the colder months.

### Pedestrian Traffic Over Time

Has the volume of Melbourne pedestrian traffic decreased over time, particularly following the pandemic whereby many workplaces transitioned to hybrid or work from home arrangements? The dataset is reformatted, grouping each pedestrian reading into its associated year and month to analyse average traffic.

### Busiest Melbourne Locations

## Analysis Aldwin

## Conclusion

## References
